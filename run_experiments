#!/bin/bash
#
# Copyright (c) 2020-present, Adriano Lange.  All rights reserved.
# This source code is licensed under both the GPLv2 (found in the
# LICENSE.GPLv2 file in the root directory) and Apache 2.0 License
# (found in the LICENSE.Apache file in the root directory).
#

source run_functions

if [ "$1" == 'mw_per_threads_writeratio' ]; then
	DURATION=61
	WARM_PERIOD=1
	RESTORE_DBS=0
	NUM_DBS=1
	DB_WORKLOAD=mixedworkload
	
	loop_threads="25 30 10 15" # 20
	for DB_THREADS in $loop_threads; do
		DB_WORKLOADSCRIPT="writeratio=0.05;16m:writeratio=0.1;31m:writeratio=0.2;46m:writeratio=0.5"
		OUTPUT="plot/exp_mw/${1}-dbs${NUM_DBS}_threads${DB_THREADS}.out"
		run_generic
	done
	
	exit 0
fi

if [ "$1" == 'mw_dbs' ]; then
	TEST_COMMANDS=1
	DURATION=61
	WARM_PERIOD=1
	RESTORE_DBS=0
	NUM_DBS=4
	DB_WORKLOAD=mixedworkload
	DB_THREADS=20
	writeratio=05
	
	DB_WORKLOADSCRIPT=`
	echo -n "writeratio=0.${writeratio}#"
	for ((i=1; i < NUM_DBS; i++)); do
		echo "wait;writeratio=0.${writeratio};$((15*i +1))m:wait=false"
	done |paste -sd'#'`
	
	OUTPUT="plot/exp_mw/${1}-dbs${NUM_DBS}_threads${DB_THREADS}_writeratio${writeratio}.out"
	run_generic
	
	exit 0
fi
